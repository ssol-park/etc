## reentrantLock

- 동기화된 코드에 대한 더 세밀한 제어를 가능하게 하는 클래스다. **재진입 가능한 락(Reentrant Lock)** 으로, 동일한 스레드가 한 번 획득한 락을 다시 획득할 수 있는 기능을 제공한다. 이는 락을 획득한 스레드가 재귀적으로 동일한 락을 다시 요청하는 경우에도 문제없이 계속 수행할 수 있게 한다.

#### 재진입 가능(Reentrancy)

- 한 스레드가 이미 락을 획득한 상태에서 동일한 락을 재귀적으로 다시 획득할 수 있다. 락 횟수를 추적하며, 락이 획득된 횟수만큼 해제되어야 한다.

#### 명시적인 락 획득 및 해제
- lock()과 unlock() 메서드를 통해 명시적으로 락을 획득하고 해제할 수 있다. synchronized 블록이 자동으로 락을 관리하는 것과 달리, 더 많은 제어권을 제공한다.

#### tryLock() 메서드
- 비블로킹 방식으로 락을 시도할 수 있다. 락을 즉시 시도하고 획득하지 못하면 false를 반환하여, 다른 대체 작업을 수행할 수 있게 한다.

#### 인터럽트 가능 락 시도
- **lockInterruptibly()** 를 통해 스레드가 락을 기다리는 동안 인터럽트될 수 있다. 락을 기다리는 도중 스레드가 인터럽트되면 예외를 던지고 대기 중이던 락 요청을 중단한다.

#### 공정성(Fairness)
- 스레드가 락을 획득하는 순서가 정해진 규칙에 따라 공정하게 이루어지느냐를 의미한다. 공정 모드와 비공정 모드를 지원하며, 이를 생성 시에 설정할 수 있다.
```java
/*
 * 공정한 락 생성 
 * 락을 기다리는 스레드들이 FIFO(First-In-First-Out) 방식으로 락을 획득한다
 * */
ReentrantLock lock = new ReentrantLock(true);

/*
 * 비공정한 락 (기본)
 * 공정성 보장 없이 락을 해제한 후 어떤 스레드가 먼저 락을 요청하느냐에 따라 락을 획득한다.
 * 락을 빠르게 사용할 수 있는 스레드가 먼저 락을 획득할 수 있다.
 * */
ReentrantLock lock = new ReentrantLock();
```

- 장점
  - 예측 가능성: 공정한 락을 사용하면 대기 중인 스레드들이 순차적으로 락을 획득하므로, 기다리는 시간이 예측 가능하다.
  -  기아 상태 방지: 오래 대기한 스레드가 **락을 획득하지 못하는 기아 상태(starvation)** 를 방지할 수 있다.

- 단점
  - 성능 저하: 공정한 락은 대기 중인 스레드가 FIFO 순서대로 락을 획득하므로, 추가적인 관리 비용이 발생해 성능이 저하될 수 있다. 
  - 비공정 락은 락을 해제하자마자 가장 빠르게 반응한 스레드가 락을 즉시 획득할 수 있어 더 빠르게 동작할 수 있다.
  - 경쟁이 적을 때 성능 우위: 스레드 간 경쟁이 적고 락을 짧은 시간 동안만 유지하는 경우, 비공정 락이 더 빠르고 효율적일 수 있다.

    
### synchronized 와의 차이점
| **기능**                  | **ReentrantLock**                                | **synchronized**                              |
|---------------------------|---------------------------------------------------|------------------------------------------------|
| **명시적 제어**            | `lock()`과 `unlock()`으로 락을 명시적으로 관리   | 자동으로 락을 관리                             |
| **공정성 옵션**            | 공정성(fairness)을 선택할 수 있음                 | 비공정성(non-fair)을 기본으로 함              |
| **타임아웃 기능**          | `tryLock(long timeout, TimeUnit unit)`으로 타임아웃 설정 가능 | 타임아웃 기능을 제공하지 않음                 |
| **인터럽트 가능성**        | `lockInterruptibly()`로 인터럽트 지원             | 인터럽트를 지원하지 않음                      |
